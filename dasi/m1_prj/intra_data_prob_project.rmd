---
title: "Intro to Data & Probability - Exploring the BRFSS data"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
bibliography: references.bib
---
<div id="intro">
The purpose of this project is to use an exploratory data analysis in an attempt to answer a few research questions from  a statistical study.
</div>


## Setup
In this project we shall user a number o R packages `ggplot2` and `gridExtra` for the visualisation of results and `dplyr` to perform transformative operations on datasets 

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(gridExtra)
library(dplyr)
```

### Load data
The BRFSS dataset is loaded from a file `brfss2013.rdata` which can be read by R directly with the load() function creating a `brfss2013` data.frame object. 

```{r load-data}
load("brfss2013.RData")
```


* * *

## Part 1: Data
The dataset used in this project comes from the "Behavioral Risk Factor Surveillance System" (BRFSS) 2013 edition. Every year the US Center for Dease Control and Prevention (CDS) asks to conduct a detailed questionnaire of health related questions within a large sample of the US population residing in all US states and territories. The BRFSS conducts landline telephone- and cellular telephone-based surveys. The data is collected uniformly across all states and all days of the edition's year through a random sampling of US adults. 
The groups of studied factors include general health status, number of unhealthy days in a past month, health care access, practice of physical activity, alcohol consumption, fruits and vegetables consumption, hypertension awareness, colesterol awareness and chronic health conditions.
The  BRFSS 2013 edition  contains a dataset of over 491 thousands of individuals spanning over several hundreds variables. This is an example of a very large continuous observational study with a generalizability of the measured data.


* * *

## Part 2: Research questions

**Research question 1:**
Having a health insurance increases the quality of life. We are interested to study how people make decisions whether to get a health insurance coverage if they have limited means to afford it. 
Does the level of education plays a role when deciding about taking or forgoing the health insurance plan? 
More precisely we shall try to answer a question if college educated people with lower income but in a good health are more likely to make an economic decision to forgo a health insurance when compared to people with a precollege education from the same income category and the same physical condition.

**Research question 2:**
In this section we shall study a variable which represents a number of days with a poor physical health  in last 30 days. The dataset has  a variable on General health. But arguably the latter is more qualitative an  the former is more quantitative. Studying numbers of sick days that people take  has a direct economic interest reflecting a net expense of wealth rather than its generation by the employed population. We are interested to study factors which can potentially reduced the number of sick days taken. Among various factors we concentrate on  a physical activity levels and  on healthy food consumption. The healthy food is computed for 2 underlying variables. 
Thus does a physical activity, a consumption of a healthy food impact the number of sick days taken? if yes, which factor has a greater influence in reducing the number of sick days?

**Research question 3:**
In this section we are interested in checking the normality of a distribution of human height.
Thus Are the studied population heights normally distributed? Our interest is driven to verify similar claims [see @ois2015, pp. 137-139]. Taller people have higher risks of health [@adu2013], [@ken2011, pp. 400] and if a human height is normally distributed the frequency of very tall humans is rare and under the 'thin tails' of the normal distribution.

* * *

## Part 3: Exploratory data analysis

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button (green button with orange arrow) above. Make sure that your code is visible
in the project you submit. Delete this note when before you submit your work.


**Research question 1:**

We start with  extracting variables from a general relevant for the subjet 1. 
`genhlth,X` is a general health status, `X_educag` contains levels of education, `X_incomg` represents various income categories and  `hlthpln1` indicates if a subject has a health insurance plan.

```{r eval=TRUE}
sel_brfss2013 <- brfss2013 %>% select (genhlth,X_rfhlth,X_educag,X_incomg,hlthpln1)
str(sel_brfss2013)
```

To distinguish individuals with college vs pre-college education a new variable `edu_cat` is created
F
```{r eval=TRUE}

#2. create a variable on education level
sel_brfss2013 <- sel_brfss2013  %>%
mutate(edu_cat = factor( ifelse( is.na(X_educag),NA
								,ifelse(X_educag %in% c("Attended college or technical school"
													   ,"Graduated from college or technical school")
														,"college education","pre-college education"))) )

```

To have a first idea about the research problem it is useful to plot relationships between studied variables

```{r eval=TRUE}
sel_brfss2013$health_condition<-sel_brfss2013$genhlth
sel_brfss2013$has_plan<-sel_brfss2013$hlthpln1
sel_brfss2013$education <-sel_brfss2013$edu_cat
sel_brfss2013$income <-sel_brfss2013$X_incomg

p1 <- ggplot(sel_brfss2013, aes(x=health_condition, fill =has_plan )) +
  geom_bar() +
  ggtitle("Health plans for different health conditions")  + 
  theme(plot.title = element_text(size = 11))

p2 <- ggplot(sel_brfss2013, aes(x=health_condition, fill =education )) +
  geom_bar() +
  ggtitle("Education level for different health conditions")  + 
  theme(plot.title = element_text(size = 11))

p3 <- ggplot(sel_brfss2013, aes(x=education, fill = income )) +
  geom_bar() +
  ggtitle("Education income levels vs education") + 
  theme(plot.title = element_text(size = 11))

grid.arrange(p1,p2,p3,nrow=3,heights=c(0.80, 0.99, 0.99) )

```

For studied factors we create new variables with less categories, 2 for health and 3 for income. We shall concentrate on individuals in the "low" income category with people making up to 25000 USD.

```{r eval=TRUE}
# create a health condition variable 
sel_brfss2013 <- sel_brfss2013  %>%
mutate(g_health =factor(ifelse(is.na(genhlth), NA
                       ,ifelse(genhlth %in% c("Excellent", "Very good", "Good"),
                        "excellent or good", "poor or fair"))) )

# create a variable on income category  low middle upper
sel_brfss2013 <- sel_brfss2013  %>%
mutate(incom_cat = factor(ifelse(is.na(X_incomg),NA
						,ifelse(X_incomg %in% 
                        c("Less than $15,000","$15,000 to less than $25,000"),"low"
                        ,ifelse(X_incomg %in% c("$25,000 to less than $35,000","$35,000 to less than $50,000")
						,"middle","upper")))) )
```


**Research question 2:**

```{r}

```



**Research question 3:**

```{r}

```
#References

